/*! wavesurfer.js 1.3.4 (Tue, 27 Feb 2018 13:42:50 GMT)
* https://github.com/katspaugh/wavesurfer.js
* @license CC-BY-3.0 */
!function(t,e){"function"==typeof define&&define.amd?define("wavesurfer",[],function(){return t.WaveSurfer=e()}):"object"==typeof module&&module.exports?module.exports=e():t.WaveSurfer=e()}(this,function(){"use strict";var t={defaultParams:{audioContext:null,audioRate:1,autoCenter:!0,backend:"WebAudio",container:null,cursorColor:"#333",cursorWidth:1,dragSelection:!0,fillParent:!0,forceDecode:!1,height:128,hideScrollbar:!1,interact:!0,loopSelection:!0,mediaContainer:null,mediaControls:!1,mediaType:"audio",minPxPerSec:20,partialRender:!1,pixelRatio:window.devicePixelRatio||screen.deviceXDPI/screen.logicalXDPI,progressColor:"#555",normalize:!1,renderer:"MultiCanvas",scrollParent:!1,skipLength:2,splitChannels:!1,waveColor:"#999"},init:function(e){if(this.params=t.util.extend({},this.defaultParams,e),this.container="string"==typeof e.container?document.querySelector(this.params.container):this.params.container,!this.container)throw new Error("Container element not found");if(null==this.params.mediaContainer?this.mediaContainer=this.container:"string"==typeof this.params.mediaContainer?this.mediaContainer=document.querySelector(this.params.mediaContainer):this.mediaContainer=this.params.mediaContainer,!this.mediaContainer)throw new Error("Media Container element not found");this.savedVolume=0,this.isMuted=!1,this.tmpEvents=[],this.currentAjax=null,this.createDrawer(),this.createBackend(),this.createPeakCache(),this.isDestroyed=!1},createDrawer:function(){var e=this;this.drawer=Object.create(t.Drawer[this.params.renderer]),this.drawer.init(this.container,this.params),this.drawer.on("redraw",function(){e.drawBuffer(),e.drawer.progress(e.backend.getPlayedPercents())}),this.drawer.on("click",function(t,i){setTimeout(function(){e.seekTo(i)},0)}),this.drawer.on("scroll",function(t){e.params.partialRender&&e.drawBuffer(),e.fireEvent("scroll",t)})},createBackend:function(){var e=this;this.backend&&this.backend.destroy(),"AudioElement"==this.params.backend&&(this.params.backend="MediaElement"),"WebAudio"!=this.params.backend||t.WebAudio.supportsWebAudio()||(this.params.backend="MediaElement"),this.backend=Object.create(t[this.params.backend]),this.backend.init(this.params),this.backend.on("finish",function(){e.fireEvent("finish")}),this.backend.on("play",function(){e.fireEvent("play")}),this.backend.on("pause",function(){e.fireEvent("pause")}),this.backend.on("audioprocess",function(t){e.drawer.progress(e.backend.getPlayedPercents()),e.fireEvent("audioprocess",t)})},createPeakCache:function(){this.params.partialRender&&(this.peakCache=Object.create(t.PeakCache),this.peakCache.init())},getDuration:function(){return this.backend.getDuration()},getCurrentTime:function(){return this.backend.getCurrentTime()},play:function(t,e){this.fireEvent("interaction",this.play.bind(this,t,e)),this.backend.play(t,e)},pause:function(){this.backend.isPaused()||this.backend.pause()},playPause:function(){this.backend.isPaused()?this.play():this.pause()},isPlaying:function(){return!this.backend.isPaused()},skipBackward:function(t){this.skip(-t||-this.params.skipLength)},skipForward:function(t){this.skip(t||this.params.skipLength)},skip:function(t){var e=this.getCurrentTime()||0,i=this.getDuration()||1;e=Math.max(0,Math.min(i,e+(t||0))),this.seekAndCenter(e/i)},seekAndCenter:function(t){this.seekTo(t),this.drawer.recenter(t)},seekTo:function(t){this.fireEvent("interaction",this.seekTo.bind(this,t));var e=this.backend.isPaused();e||this.backend.pause();var i=this.params.scrollParent;this.params.scrollParent=!1,this.backend.seekTo(t*this.getDuration()),this.drawer.progress(this.backend.getPlayedPercents()),e||this.backend.play(),this.params.scrollParent=i,this.fireEvent("seek",t)},stop:function(){this.pause(),this.seekTo(0),this.drawer.progress(0)},setVolume:function(t){this.backend.setVolume(t)},getVolume:function(){return this.backend.getVolume()},setPlaybackRate:function(t){this.backend.setPlaybackRate(t)},getPlaybackRate:function(){return this.backend.getPlaybackRate()},toggleMute:function(){this.setMute(!this.isMuted)},setMute:function(t){t!==this.isMuted&&(t?(this.savedVolume=this.backend.getVolume(),this.backend.setVolume(0),this.isMuted=!0):(this.backend.setVolume(this.savedVolume),this.isMuted=!1))},getMute:function(){return this.isMuted},getFilters:function(){return this.backend.filters||[]},toggleScroll:function(){this.params.scrollParent=!this.params.scrollParent,this.drawBuffer()},toggleInteraction:function(){this.params.interact=!this.params.interact},drawBuffer:function(){var t=Math.round(this.getDuration()*this.params.minPxPerSec*this.params.pixelRatio),e=this.drawer.getWidth(),i=t,s=this.drawer.getScrollX();Math.min(s+e,i);this.params.fillParent&&(!this.params.scrollParent||t<e)&&(s=0,i=e);var a=this.backend,r=this.drawer,n=this;if(void 0!==a.peaks&&!(a.peaks instanceof Array)){var h=new XMLHttpRequest;h.onreadystatechange=function(){if(4==h.readyState&&200==h.status){var t=JSON.parse(h.responseText);a.peaks=t.data,r.drawPeaks(a.peaks,i),n.fireEvent("redraw",a.peaks,i),n.fireEvent("ready")}},h.open("GET",a.peaks,!0),h.send(null)}},zoom:function(t){this.params.minPxPerSec=t,this.params.scrollParent=!0,this.drawBuffer(),this.drawer.progress(this.backend.getPlayedPercents()),this.drawer.recenter(this.getCurrentTime()/this.getDuration()),this.fireEvent("zoom",t)},loadArrayBuffer:function(t){this.decodeArrayBuffer(t,function(t){this.isDestroyed||this.loadDecodedBuffer(t)}.bind(this))},loadDecodedBuffer:function(t){this.backend.load(t),this.drawBuffer(),this.fireEvent("ready")},loadBlob:function(t){var e=this,i=new FileReader;i.addEventListener("progress",function(t){e.onProgress(t)}),i.addEventListener("load",function(t){e.loadArrayBuffer(t.target.result)}),i.addEventListener("error",function(){e.fireEvent("error","Error reading file")}),i.readAsArrayBuffer(t),this.empty()},load:function(t,e,i){switch(this.empty(),this.params.backend){case"WebAudio":return this.loadBuffer(t,e);case"MediaElement":return this.loadMediaElement(t,e,i)}},loadBuffer:function(t,e){var i=function(e){return e&&this.tmpEvents.push(this.once("ready",e)),this.getArrayBuffer(t,this.loadArrayBuffer.bind(this))}.bind(this);if(!e)return i();this.backend.setPeaks(e),this.drawBuffer(),this.tmpEvents.push(this.once("interaction",i))},loadMediaElement:function(t,e,i){var s=t;if("string"==typeof t)this.backend.load(s,this.mediaContainer,e,i);else{var a=t;this.backend.loadElt(a,e),s=a.src}this.tmpEvents.push(this.backend.once("canplay",function(){this.drawBuffer()}.bind(this)),this.backend.once("error",function(t){this.fireEvent("error",t)}.bind(this))),e&&this.backend.setPeaks(e),e&&!this.params.forceDecode||!this.backend.supportsWebAudio()||this.getArrayBuffer(s,function(t){this.decodeArrayBuffer(t,function(t){this.backend.buffer=t,this.backend.setPeaks(null),this.drawBuffer(),this.fireEvent("waveform-ready")}.bind(this))}.bind(this))},decodeArrayBuffer:function(t,e){this.arraybuffer=t,this.backend.decodeArrayBuffer(t,function(i){this.isDestroyed||this.arraybuffer!=t||(e(i),this.arraybuffer=null)}.bind(this),this.fireEvent.bind(this,"error","Error decoding audiobuffer"))},getArrayBuffer:function(e,i){var s=this,a=t.util.ajax({url:e,responseType:"arraybuffer"});return this.currentAjax=a,this.tmpEvents.push(a.on("progress",function(t){s.onProgress(t)}),a.on("success",function(t,e){i(t),s.currentAjax=null}),a.on("error",function(t){s.fireEvent("error","XHR error: "+t.target.statusText),s.currentAjax=null})),a},onProgress:function(t){if(t.lengthComputable)var e=t.loaded/t.total;else e=t.loaded/(t.loaded+1e6);this.fireEvent("loading",Math.round(100*e),t.target)},exportPCM:function(t,e,i){t=t||1024,e=e||1e4,i=i||!1;var s=this.backend.getPeaks(t,e),a=[].map.call(s,function(t){return Math.round(t*e)/e}),r=JSON.stringify(a);return i||window.open("data:application/json;charset=utf-8,"+encodeURIComponent(r)),r},exportImage:function(t,e){return t||(t="image/png"),e||(e=1),this.drawer.getImage(t,e)},cancelAjax:function(){this.currentAjax&&(this.currentAjax.xhr.abort(),this.currentAjax=null)},clearTmpEvents:function(){this.tmpEvents.forEach(function(t){t.un()})},empty:function(){this.backend.isPaused()||(this.stop(),this.backend.disconnectSource()),this.cancelAjax(),this.clearTmpEvents(),this.drawer.progress(0),this.drawer.setWidth(0),this.drawer.drawPeaks({length:this.drawer.getWidth()},0)},destroy:function(){this.fireEvent("destroy"),this.cancelAjax(),this.clearTmpEvents(),this.unAll(),this.backend.destroy(),this.drawer.destroy(),this.isDestroyed=!0}};return t.create=function(e){var i=Object.create(t);return i.init(e),i},t.util={extend:function(t){return Array.prototype.slice.call(arguments,1).forEach(function(e){Object.keys(e).forEach(function(i){t[i]=e[i]})}),t},debounce:function(t,e,i){var s,a,r,n=function(){r=null,i||t.apply(a,s)};return function(){a=this,s=arguments;var h=i&&!r;clearTimeout(r),(r=setTimeout(n,e))||(r=setTimeout(n,e)),h&&t.apply(a,s)}},min:function(t){var e=1/0;for(var i in t)t[i]<e&&(e=t[i]);return e},max:function(t){var e=-1/0;for(var i in t)t[i]>e&&(e=t[i]);return e},getId:function(){return"wavesurfer_"+Math.random().toString(32).substring(2)},ajax:function(e){var i=Object.create(t.Observer),s=new XMLHttpRequest,a=!1;return s.open(e.method||"GET",e.url,!0),s.responseType=e.responseType||"json",s.addEventListener("progress",function(t){i.fireEvent("progress",t),t.lengthComputable&&t.loaded==t.total&&(a=!0)}),s.addEventListener("load",function(t){a||i.fireEvent("progress",t),i.fireEvent("load",t),200==s.status||206==s.status?i.fireEvent("success",s.response,t):i.fireEvent("error",t)}),s.addEventListener("error",function(t){i.fireEvent("error",t)}),s.send(),i.xhr=s,i}},t.Observer={on:function(t,e){this.handlers||(this.handlers={});var i=this.handlers[t];return i||(i=this.handlers[t]=[]),i.push(e),{name:t,callback:e,un:this.un.bind(this,t,e)}},un:function(t,e){if(this.handlers){var i=this.handlers[t];if(i)if(e)for(var s=i.length-1;s>=0;s--)i[s]==e&&i.splice(s,1);else i.length=0}},unAll:function(){this.handlers=null},once:function(t,e){var i=this,s=function(){e.apply(this,arguments),setTimeout(function(){i.un(t,s)},0)};return this.on(t,s)},fireEvent:function(t){if(this.handlers){var e=this.handlers[t],i=Array.prototype.slice.call(arguments,1);e&&e.forEach(function(t){t.apply(null,i)})}}},t.util.extend(t,t.Observer),t.WebAudio={scriptBufferSize:256,PLAYING_STATE:0,PAUSED_STATE:1,FINISHED_STATE:2,supportsWebAudio:function(){return!(!window.AudioContext&&!window.webkitAudioContext)},getAudioContext:function(){return this.ac||(this.ac=new(window.AudioContext||window.webkitAudioContext)),this.ac},getOfflineAudioContext:function(e){return t.WebAudio.offlineAudioContext||(t.WebAudio.offlineAudioContext=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,2,e)),t.WebAudio.offlineAudioContext},init:function(e){this.params=e,this.ac=e.audioContext||this.getAudioContext(),this.lastPlay=this.ac.currentTime,this.startPosition=0,this.scheduledPause=null,this.states=[Object.create(t.WebAudio.state.playing),Object.create(t.WebAudio.state.paused),Object.create(t.WebAudio.state.finished)],this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode(),this.setState(this.PAUSED_STATE),this.setPlaybackRate(this.params.audioRate),this.setLength(0)},disconnectFilters:function(){this.filters&&(this.filters.forEach(function(t){t&&t.disconnect()}),this.filters=null,this.analyser.connect(this.gainNode))},setState:function(t){this.state!==this.states[t]&&(this.state=this.states[t],this.state.init.call(this))},setFilter:function(){this.setFilters([].slice.call(arguments))},setFilters:function(t){this.disconnectFilters(),t&&t.length&&(this.filters=t,this.analyser.disconnect(),t.reduce(function(t,e){return t.connect(e),e},this.analyser).connect(this.gainNode))},createScriptNode:function(){this.ac.createScriptProcessor?this.scriptNode=this.ac.createScriptProcessor(this.scriptBufferSize):this.scriptNode=this.ac.createJavaScriptNode(this.scriptBufferSize),this.scriptNode.connect(this.ac.destination)},addOnAudioProcess:function(){var t=this;this.scriptNode.onaudioprocess=function(){var e=t.getCurrentTime();e>=t.getDuration()?(t.setState(t.FINISHED_STATE),t.fireEvent("pause")):e>=t.scheduledPause?t.pause():t.state===t.states[t.PLAYING_STATE]&&t.fireEvent("audioprocess",e)}},removeOnAudioProcess:function(){this.scriptNode.onaudioprocess=null},createAnalyserNode:function(){this.analyser=this.ac.createAnalyser(),this.analyser.connect(this.gainNode)},createVolumeNode:function(){this.ac.createGain?this.gainNode=this.ac.createGain():this.gainNode=this.ac.createGainNode(),this.gainNode.connect(this.ac.destination)},setVolume:function(t){this.gainNode.gain.value=t},getVolume:function(){return this.gainNode.gain.value},decodeArrayBuffer:function(t,e,i){this.offlineAc||(this.offlineAc=this.getOfflineAudioContext(this.ac?this.ac.sampleRate:44100)),this.offlineAc.decodeAudioData(t,function(t){e(t)}.bind(this),i)},setPeaks:function(t){this.peaks=t},setLength:function(t){if(!this.mergedPeaks||t!=2*this.mergedPeaks.length-1+2){this.splitPeaks=[],this.mergedPeaks=[];for(var e=this.buffer?this.buffer.numberOfChannels:1,i=0;i<e;i++)this.splitPeaks[i]=[],this.splitPeaks[i][2*(t-1)]=0,this.splitPeaks[i][2*(t-1)+1]=0;this.mergedPeaks[2*(t-1)]=0,this.mergedPeaks[2*(t-1)+1]=0}},getPeaks:function(t,e,i){if(this.peaks)return this.peaks;this.setLength(t);for(var s=this.buffer.length/t,a=~~(s/10)||1,r=this.buffer.numberOfChannels,n=0;n<r;n++)for(var h=this.splitPeaks[n],o=this.buffer.getChannelData(n),c=e;c<=i;c++){for(var l=~~(c*s),u=~~(l+s),d=0,f=0,p=l;p<u;p+=a){var m=o[p];m>f&&(f=m),m<d&&(d=m)}h[2*c]=f,h[2*c+1]=d,(0==n||f>this.mergedPeaks[2*c])&&(this.mergedPeaks[2*c]=f),(0==n||d<this.mergedPeaks[2*c+1])&&(this.mergedPeaks[2*c+1]=d)}return this.params.splitChannels?this.splitPeaks:this.mergedPeaks},getPlayedPercents:function(){return this.state.getPlayedPercents.call(this)},disconnectSource:function(){this.source&&this.source.disconnect()},destroy:function(){this.isPaused()||this.pause(),this.unAll(),this.buffer=null,this.disconnectFilters(),this.disconnectSource(),this.gainNode.disconnect(),this.scriptNode.disconnect(),this.analyser.disconnect(),this.params.audioContext||"function"==typeof this.ac.close&&this.ac.close()},load:function(t){this.startPosition=0,this.lastPlay=this.ac.currentTime,this.buffer=t,this.createSource()},createSource:function(){this.disconnectSource(),this.source=this.ac.createBufferSource(),this.source.start=this.source.start||this.source.noteGrainOn,this.source.stop=this.source.stop||this.source.noteOff,this.source.playbackRate.value=this.playbackRate,this.source.buffer=this.buffer,this.source.connect(this.analyser)},isPaused:function(){return this.state!==this.states[this.PLAYING_STATE]},getDuration:function(){return this.buffer?this.buffer.duration:0},seekTo:function(t,e){if(this.buffer)return this.scheduledPause=null,null==t&&(t=this.getCurrentTime())>=this.getDuration()&&(t=0),null==e&&(e=this.getDuration()),this.startPosition=t,this.lastPlay=this.ac.currentTime,this.state===this.states[this.FINISHED_STATE]&&this.setState(this.PAUSED_STATE),{start:t,end:e}},getPlayedTime:function(){return(this.ac.currentTime-this.lastPlay)*this.playbackRate},play:function(t,e){if(this.buffer){this.createSource();var i=this.seekTo(t,e);t=i.start,e=i.end,this.scheduledPause=e,this.source.start(0,t,e-t),"suspended"==this.ac.state&&this.ac.resume&&this.ac.resume(),this.setState(this.PLAYING_STATE),this.fireEvent("play")}},pause:function(){this.scheduledPause=null,this.startPosition+=this.getPlayedTime(),this.source&&this.source.stop(0),this.setState(this.PAUSED_STATE),this.fireEvent("pause")},getCurrentTime:function(){return this.state.getCurrentTime.call(this)},getPlaybackRate:function(){return this.playbackRate},setPlaybackRate:function(t){t=t||1,this.isPaused()?this.playbackRate=t:(this.pause(),this.playbackRate=t,this.play())}},t.WebAudio.state={},t.WebAudio.state.playing={init:function(){this.addOnAudioProcess()},getPlayedPercents:function(){var t=this.getDuration();return this.getCurrentTime()/t||0},getCurrentTime:function(){return this.startPosition+this.getPlayedTime()}},t.WebAudio.state.paused={init:function(){this.removeOnAudioProcess()},getPlayedPercents:function(){var t=this.getDuration();return this.getCurrentTime()/t||0},getCurrentTime:function(){return this.startPosition}},t.WebAudio.state.finished={init:function(){this.removeOnAudioProcess(),this.fireEvent("finish")},getPlayedPercents:function(){return 1},getCurrentTime:function(){return this.getDuration()}},t.util.extend(t.WebAudio,t.Observer),t.MediaElement=Object.create(t.WebAudio),t.util.extend(t.MediaElement,{init:function(t){this.params=t,this.media={currentTime:0,duration:0,paused:!0,playbackRate:1,play:function(){},pause:function(){}},this.mediaType=t.mediaType.toLowerCase(),this.elementPosition=t.elementPosition,this.setPlaybackRate(this.params.audioRate),this.createTimer()},createTimer:function(){var t=this,e=function(){t.isPaused()||(t.fireEvent("audioprocess",t.getCurrentTime()),(window.requestAnimationFrame||window.webkitRequestAnimationFrame)(e))};this.on("play",e)},load:function(t,e,i,s){var a=document.createElement(this.mediaType);a.controls=this.params.mediaControls,a.autoplay=this.params.autoplay||!1,a.preload=null==s?"auto":s,a.src=t,a.style.width="100%";var r=e.querySelector(this.mediaType);r&&(a.volume=r.volume,r.preload="none",e.removeChild(r)),e.appendChild(a),this._load(a,i)},loadElt:function(t,e){var i=t;i.controls=this.params.mediaControls,i.autoplay=this.params.autoplay||!1,this._load(i,e)},_load:function(t,e){var i=this;"function"==typeof t.load&&t.load(),t.addEventListener("error",function(){i.fireEvent("error","Error loading media element")}),t.addEventListener("canplay",function(){i.fireEvent("canplay")}),t.addEventListener("ended",function(){i.fireEvent("finish")}),this.media=t,this.peaks=e,this.onPlayEnd=null,this.buffer=null,this.setPlaybackRate(this.playbackRate)},isPaused:function(){return!this.media||this.media.paused},getDuration:function(){var t=(this.buffer||this.media).duration;return t>=1/0&&(t=this.media.seekable.end(0)),t},getCurrentTime:function(){return this.media&&this.media.currentTime},getPlayedPercents:function(){return this.getCurrentTime()/this.getDuration()||0},setPlaybackRate:function(t){this.playbackRate=t||1,this.media.playbackRate=this.playbackRate},seekTo:function(t){null==t||isNaN(t)||(this.media.currentTime=t),this.clearPlayEnd()},play:function(t,e){this.seekTo(t),this.media.play(),e&&this.setPlayEnd(e),this.fireEvent("play")},pause:function(){this.media&&this.media.pause(),this.clearPlayEnd(),this.fireEvent("pause")},setPlayEnd:function(t){var e=this;this.onPlayEnd=function(i){i>=t&&(e.pause(),e.seekTo(t))},this.on("audioprocess",this.onPlayEnd)},clearPlayEnd:function(){this.onPlayEnd&&(this.un("audioprocess",this.onPlayEnd),this.onPlayEnd=null)},getPeaks:function(e,i,s){return this.buffer?t.WebAudio.getPeaks.call(this,e,i,s):this.peaks||[]},getVolume:function(){return this.media.volume},setVolume:function(t){this.media.volume=t},destroy:function(){this.pause(),this.unAll(),this.media&&this.media.parentNode&&this.media.parentNode.removeChild(this.media),this.media=null}}),t.AudioElement=t.MediaElement,t.Drawer={init:function(t,e){this.container=t,this.params=e,this.width=0,this.height=e.height*this.params.pixelRatio,this.lastPos=0,this.initDrawer(e),this.createWrapper(),this.createElements()},createWrapper:function(){this.wrapper=this.container.appendChild(document.createElement("wave")),this.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.params.height+"px"}),(this.params.fillParent||this.params.scrollParent)&&this.style(this.wrapper,{width:"100%",overflowX:this.params.hideScrollbar?"hidden":"auto",overflowY:"hidden"}),this.setupWrapperEvents()},handleEvent:function(t,e){!e&&t.preventDefault();var i,s=t.targetTouches?t.targetTouches[0].clientX:t.clientX,a=this.wrapper.getBoundingClientRect(),r=this.width,n=this.getWidth();return!this.params.fillParent&&r<n?(i=(s-a.left)*this.params.pixelRatio/r||0)>1&&(i=1):i=(s-a.left+this.wrapper.scrollLeft)/this.wrapper.scrollWidth||0,i},setupWrapperEvents:function(){var t=this;this.wrapper.addEventListener("click",function(e){var i=t.wrapper.offsetHeight-t.wrapper.clientHeight;if(0!=i){var s=t.wrapper.getBoundingClientRect();if(e.clientY>=s.bottom-i)return}t.params.interact&&t.fireEvent("click",e,t.handleEvent(e))}),this.wrapper.addEventListener("scroll",function(e){t.fireEvent("scroll",e)})},drawPeaks:function(t,e,i,s){this.setWidth(e),this.params.barWidth?this.drawBars(t,0,i,s):this.drawWave(t,0,i,s)},style:function(t,e){return Object.keys(e).forEach(function(i){t.style[i]!==e[i]&&(t.style[i]=e[i])}),t},resetScroll:function(){null!==this.wrapper&&(this.wrapper.scrollLeft=0)},recenter:function(t){var e=this.wrapper.scrollWidth*t;this.recenterOnPosition(e,!0)},recenterOnPosition:function(t,e){var i=this.wrapper.scrollLeft,s=~~(this.wrapper.clientWidth/2),a=t-s,r=a-i,n=this.wrapper.scrollWidth-this.wrapper.clientWidth;if(0!=n){if(!e&&-s<=r&&r<s){a=i+(r=Math.max(-5,Math.min(5,r)))}(a=Math.max(0,Math.min(n,a)))!=i&&(this.wrapper.scrollLeft=a)}},getScrollX:function(){return Math.round(this.wrapper.scrollLeft*this.params.pixelRatio)},getWidth:function(){return Math.round(this.container.clientWidth*this.params.pixelRatio)},setWidth:function(t){this.width!=t&&(this.width=t,this.params.fillParent||this.params.scrollParent?this.style(this.wrapper,{width:""}):this.style(this.wrapper,{width:~~(this.width/this.params.pixelRatio)+"px"}),this.updateSize())},setHeight:function(t){t!=this.height&&(this.height=t,this.style(this.wrapper,{height:~~(this.height/this.params.pixelRatio)+"px"}),this.updateSize())},progress:function(t){var e=1/this.params.pixelRatio,i=Math.round(t*this.width)*e;if(i<this.lastPos||i-this.lastPos>=e){if(this.lastPos=i,this.params.scrollParent&&this.params.autoCenter){var s=~~(this.wrapper.scrollWidth*t);this.recenterOnPosition(s)}this.updateProgress(i)}},destroy:function(){this.unAll(),this.wrapper&&(this.container.removeChild(this.wrapper),this.wrapper=null)},initDrawer:function(){},createElements:function(){},updateSize:function(){},drawWave:function(t,e){},clearWave:function(){},updateProgress:function(t){}},t.util.extend(t.Drawer,t.Observer),t.Drawer.Canvas=Object.create(t.Drawer),t.util.extend(t.Drawer.Canvas,{createElements:function(){var t=this.wrapper.appendChild(this.style(document.createElement("canvas"),{position:"absolute",zIndex:1,left:0,top:0,bottom:0}));if(this.waveCc=t.getContext("2d"),this.progressWave=this.wrapper.appendChild(this.style(document.createElement("wave"),{position:"absolute",zIndex:2,left:0,top:0,bottom:0,overflow:"hidden",width:"0",display:"none",boxSizing:"border-box",borderRightStyle:"solid",borderRightWidth:this.params.cursorWidth+"px",borderRightColor:this.params.cursorColor})),this.params.waveColor!=this.params.progressColor){var e=this.progressWave.appendChild(document.createElement("canvas"));this.progressCc=e.getContext("2d")}},updateSize:function(){var t=Math.round(this.width/this.params.pixelRatio);this.waveCc.canvas.width=this.width,this.waveCc.canvas.height=this.height,this.style(this.waveCc.canvas,{width:t+"px"}),this.style(this.progressWave,{display:"block"}),this.progressCc&&(this.progressCc.canvas.width=this.width,this.progressCc.canvas.height=this.height,this.style(this.progressCc.canvas,{width:t+"px"})),this.clearWave()},clearWave:function(){this.waveCc.clearRect(0,0,this.width,this.height),this.progressCc&&this.progressCc.clearRect(0,0,this.width,this.height)},drawBars:function(e,i,s,a){var r=this;if(e[0]instanceof Array){var n=e;if(this.params.splitChannels)return this.setHeight(n.length*this.params.height*this.params.pixelRatio),void n.forEach(function(t,e){r.drawBars(t,e,s,a)});e=n[0]}var h=1;[].some.call(e,function(t){return t<0})&&(h=2);var o=.5/this.params.pixelRatio,c=this.width,l=this.params.height*this.params.pixelRatio,u=l*i||0,d=l/2,f=e.length/h,p=this.params.barWidth*this.params.pixelRatio,m=Math.max(this.params.pixelRatio,~~(p/2)),v=p+m,g=1;if(this.params.normalize){var w=t.util.max(e),C=t.util.min(e);g=-C>w?-C:w}var y=f/c;this.waveCc.fillStyle=this.params.waveColor,this.progressCc&&(this.progressCc.fillStyle=this.params.progressColor),[this.waveCc,this.progressCc].forEach(function(t){if(t)for(var i=0;i<c;i+=v){var s=Math.round(e[Math.floor(i*y)]/g*d)+1;t.fillRect(i+o,d-s+u,p+o,2*s)}},this)},drawWave:function(e,i,s,a){var r=this;if(e[0]instanceof Array){var n=e;if(this.params.splitChannels)return this.setHeight(n.length*this.params.height*this.params.pixelRatio),void n.forEach(function(t,e){r.drawWave(t,e,s,a)});e=n[0]}if(![].some.call(e,function(t){return t<0})){for(var h=[],o=0,c=e.length;o<c;o++)h[2*o]=e[o],h[2*o+1]=-e[o];e=h}var l=.5/this.params.pixelRatio,u=this.params.height*this.params.pixelRatio,d=u*i||0,f=u/2,p=~~(e.length/2),m=1;this.params.fillParent&&this.width!=p&&(m=this.width/p);var v=1;if(this.params.normalize){var g=t.util.max(e),w=t.util.min(e);v=-w>g?-w:g}this.waveCc.fillStyle=this.params.waveColor,this.progressCc&&(this.progressCc.fillStyle=this.params.progressColor),[this.waveCc,this.progressCc].forEach(function(t){if(t){t.beginPath(),t.moveTo(s*m+l,f+d);for(i=s;i<a;i++){r=Math.round(e[2*i]/v*f);t.lineTo(i*m+l,f-r+d)}for(var i=a-1;i>=s;i--){var r=Math.round(e[2*i+1]/v*f);t.lineTo(i*m+l,f-r+d)}t.closePath(),t.fill(),t.fillRect(0,f+d-l,this.width,l)}},this)},updateProgress:function(t){this.style(this.progressWave,{width:t+"px"})},getImage:function(t,e){return this.waveCc.canvas.toDataURL(t,e)}}),t.Drawer.MultiCanvas=Object.create(t.Drawer),t.util.extend(t.Drawer.MultiCanvas,{initDrawer:function(t){if(this.maxCanvasWidth=null!=t.maxCanvasWidth?t.maxCanvasWidth:4e3,this.maxCanvasElementWidth=Math.round(this.maxCanvasWidth/this.params.pixelRatio),this.maxCanvasWidth<=1)throw"maxCanvasWidth must be greater than 1.";if(this.maxCanvasWidth%2==1)throw"maxCanvasWidth must be an even number.";this.hasProgressCanvas=this.params.waveColor!=this.params.progressColor,this.halfPixel=.5/this.params.pixelRatio,this.canvases=[]},createElements:function(){this.progressWave=this.wrapper.appendChild(this.style(document.createElement("wave"),{position:"absolute",zIndex:2,left:0,top:0,bottom:0,overflow:"hidden",width:"0",display:"none",boxSizing:"border-box",borderRightStyle:"solid",borderRightWidth:this.params.cursorWidth+"px",borderRightColor:this.params.cursorColor})),this.addCanvas()},updateSize:function(){for(var t=Math.round(this.width/this.params.pixelRatio),e=Math.ceil(t/this.maxCanvasElementWidth);this.canvases.length<e;)this.addCanvas();for(;this.canvases.length>e;)this.removeCanvas();for(var i in this.canvases){var s=this.maxCanvasWidth+2*Math.ceil(this.params.pixelRatio/2);i==this.canvases.length-1&&(s=this.width-this.maxCanvasWidth*(this.canvases.length-1)),this.updateDimensions(this.canvases[i],s,this.height),this.clearWaveForEntry(this.canvases[i])}},addCanvas:function(){var t={},e=this.maxCanvasElementWidth*this.canvases.length;t.wave=this.wrapper.appendChild(this.style(document.createElement("canvas"),{position:"absolute",zIndex:1,left:e+"px",top:0,bottom:0})),t.waveCtx=t.wave.getContext("2d"),this.hasProgressCanvas&&(t.progress=this.progressWave.appendChild(this.style(document.createElement("canvas"),{position:"absolute",left:e+"px",top:0,bottom:0})),t.progressCtx=t.progress.getContext("2d")),this.canvases.push(t)},removeCanvas:function(){var t=this.canvases.pop();t.wave.parentElement.removeChild(t.wave),this.hasProgressCanvas&&t.progress.parentElement.removeChild(t.progress)},updateDimensions:function(t,e,i){var s=Math.round(e/this.params.pixelRatio),a=Math.round(this.width/this.params.pixelRatio);t.start=t.waveCtx.canvas.offsetLeft/a||0,t.end=t.start+s/a,t.waveCtx.canvas.width=e,t.waveCtx.canvas.height=i,this.style(t.waveCtx.canvas,{width:s+"px"}),this.style(this.progressWave,{display:"block"}),this.hasProgressCanvas&&(t.progressCtx.canvas.width=e,t.progressCtx.canvas.height=i,this.style(t.progressCtx.canvas,{width:s+"px"}))},clearWave:function(){for(var t in this.canvases)this.clearWaveForEntry(this.canvases[t])},clearWaveForEntry:function(t){t.waveCtx.clearRect(0,0,t.waveCtx.canvas.width,t.waveCtx.canvas.height),this.hasProgressCanvas&&t.progressCtx.clearRect(0,0,t.progressCtx.canvas.width,t.progressCtx.canvas.height)},drawBars:function(e,i,s,a){var r=this;if(e[0]instanceof Array){var n=e;if(this.params.splitChannels)return this.setHeight(n.length*this.params.height*this.params.pixelRatio),void n.forEach(function(t,e){r.drawBars(t,e,s,a)});e=n[0]}var h=1;[].some.call(e,function(t){return t<0})&&(h=2);var o=this.width,c=this.params.height*this.params.pixelRatio,l=c*i||0,u=c/2,d=e.length/h,f=this.params.barWidth*this.params.pixelRatio,p=f+Math.max(this.params.pixelRatio,~~(f/2)),m=1;if(this.params.normalize){var v=t.util.max(e),g=t.util.min(e);m=-g>v?-g:v}for(var w=d/o,C=0;C<o;C+=p){var y=Math.round(e[Math.floor(C*w)]/m*u)+1;this.fillRect(C+this.halfPixel,u-y+l,f+this.halfPixel,2*y)}},drawWave:function(e,i,s,a){var r=this;if(e[0]instanceof Array){var n=e;if(this.params.splitChannels)return this.setHeight(n.length*this.params.height*this.params.pixelRatio),void n.forEach(function(t,e){r.drawWave(t,e,s,a)});e=n[0]}if(![].some.call(e,function(t){return t<0})){for(var h=[],o=0,c=e.length;o<c;o++)h[2*o]=e[o],h[2*o+1]=-e[o];e=h}var l=this.params.height*this.params.pixelRatio,u=l*i||0,d=l/2,f=1;if(this.params.normalize){var p=t.util.max(e),m=t.util.min(e);f=-m>p?-m:p}this.drawLine(e,f,d,u,s,a),this.fillRect(0,d+u-this.halfPixel,this.width,this.halfPixel)},drawLine:function(t,e,i,s,a,r){for(var n in this.canvases){var h=this.canvases[n];this.setFillStyles(h),this.drawLineToContext(h,h.waveCtx,t,e,i,s,a,r),this.drawLineToContext(h,h.progressCtx,t,e,i,s,a,r)}},drawLineToContext:function(t,e,i,s,a,r,n,h){if(e){var o=i.length/2,c=1;this.params.fillParent&&this.width!=o&&(c=this.width/o);var l=Math.round(o*t.start),u=Math.round(o*t.end);if(!(l>h||u<n)){var d=Math.max(l,n),f=Math.min(u,h);e.beginPath(),e.moveTo((d-l)*c+this.halfPixel,a+r);for(v=d;v<f;v++){var p=i[2*v]||0,m=Math.round(p/s*a);e.lineTo((v-l)*c+this.halfPixel,a-m+r)}for(var v=f-1;v>=d;v--){var p=i[2*v+1]||0,m=Math.round(p/s*a);e.lineTo((v-l)*c+this.halfPixel,a-m+r)}e.closePath(),e.fill()}}},fillRect:function(t,e,i,s){for(var a=Math.floor(t/this.maxCanvasWidth),r=Math.min(Math.ceil((t+i)/this.maxCanvasWidth)+1,this.canvases.length),n=a;n<r;n++){var h=this.canvases[n],o=n*this.maxCanvasWidth,c={x1:Math.max(t,n*this.maxCanvasWidth),y1:e,x2:Math.min(t+i,n*this.maxCanvasWidth+h.waveCtx.canvas.width),y2:e+s};c.x1<c.x2&&(this.setFillStyles(h),this.fillRectToContext(h.waveCtx,c.x1-o,c.y1,c.x2-c.x1,c.y2-c.y1),this.fillRectToContext(h.progressCtx,c.x1-o,c.y1,c.x2-c.x1,c.y2-c.y1))}},fillRectToContext:function(t,e,i,s,a){t&&t.fillRect(e,i,s,a)},setFillStyles:function(t){t.waveCtx.fillStyle=this.params.waveColor,this.hasProgressCanvas&&(t.progressCtx.fillStyle=this.params.progressColor)},updateProgress:function(t){this.style(this.progressWave,{width:t+"px"})}}),t.PeakCache={init:function(){this.clearPeakCache()},clearPeakCache:function(){this.peakCacheRanges=[],this.peakCacheLength=-1},addRangeToPeakCache:function(t,e,i){t!=this.peakCacheLength&&(this.clearPeakCache(),this.peakCacheLength=t);for(var s=[],a=0;a<this.peakCacheRanges.length&&this.peakCacheRanges[a]<e;)a++;for(a%2==0&&s.push(e);a<this.peakCacheRanges.length&&this.peakCacheRanges[a]<=i;)s.push(this.peakCacheRanges[a]),a++;a%2==0&&s.push(i),s=s.filter(function(t,e,i){return 0==e?t!=i[e+1]:e==i.length-1?t!=i[e-1]:t!=i[e-1]&&t!=i[e+1]}),this.peakCacheRanges=this.peakCacheRanges.concat(s),this.peakCacheRanges=this.peakCacheRanges.sort(function(t,e){return t-e}).filter(function(t,e,i){return 0==e?t!=i[e+1]:e==i.length-1?t!=i[e-1]:t!=i[e-1]&&t!=i[e+1]});var r=[];for(a=0;a<s.length;a+=2)r.push([s[a],s[a+1]]);return r},getCacheRanges:function(){for(var t=[],e=0;e<this.peakCacheRanges.length;e+=2)t.push([this.peakCacheRanges[e],this.peakCacheRanges[e+1]]);return t}},function(){var e=function(){var e=document.querySelectorAll("wavesurfer");Array.prototype.forEach.call(e,function(e){var i=t.util.extend({container:e,backend:"MediaElement",mediaControls:!0},e.dataset);e.style.display="block";var s=t.create(i);if(e.dataset.peaks)var a=JSON.parse(e.dataset.peaks);s.load(e.dataset.url,a)})};"complete"===document.readyState?e():window.addEventListener("load",e)}(),t});
//# sourceMappingURL=wavesurfer.min.js.map